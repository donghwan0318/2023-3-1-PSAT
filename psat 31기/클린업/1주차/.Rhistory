x = "charges", y = "density") +
theme_bw()
x = "charges", y = "density"+theme(plot.title = element_text(hjust = 0.5)) +
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker),alpha=0.1)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_bw()
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker),alpha=0.1)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8,fill='white') +
geom_density(aes(colour=smoker),alpha=0.1)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker),alpha=0.1)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.1)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
labs(x = "charges", y = "density") +
theme_bw()+
theme(panel.grid.major = element_line(color = "white"),
panel.grid.minor = element_line(color = "white"))
labs(x = "charges", y = "density") +
theme_bw()+
theme(panel.background = element_rect(fill = "white"))
labs(x = "charges", y = "density") +
theme_bw()
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
labs(x = "charges", y = "density") +
theme_bw()
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
labs(x = "charges", y = "density") +
theme_bw()+
theme(panel.background = element_rect(fill = "white"))
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))+
labs(x = "charges", y = "density") +
theme_bw()
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))+
labs(x = "charges", y = "density") +
theme_void()
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))+
labs(x = "charges", y = "density") +
theme_bw()
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))+
labs(x = "charges", y = "density") +
theme_classic()
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 2000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1500, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1000, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geo_boxplot()
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot()
names(my_palette) <- c("elder","senior", "young")
my_palette <- brewer.pal(3, "Pastel1")
names(my_palette) <- c("elder","senior", "young")
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group))
my_palette <- brewer.pal(3, "Pastel1")
my_palette <- brewer.pal(3, "Pastel1")
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),color='black')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),color='black',alpha=0.8)
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),color='black',alpha=0.7)
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.7),color='black')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')
my_palette
my_palette <- brewer.pal(3, "Pastel1")
names(my_palette)<-c('elder','young','senior')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')
my_palette <-c("#FBB4AE" , "#CCEBC5","#B3CDE3")
names(my_palette)<-c('elder','young','senior')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')
names(my_palette)<-c('elder','senior','senior')
names(my_palette)<-c('elder','young','senior')
my_palette <-c("#FBB4AE" , "#CCEBC5","#B3CDE3")
names(my_palette)<-c('elder','young','senior')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')
my_palette <- brewer.pal(3, "Pastel1")
names(my_palette)<-c('elder','young','senior')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
scale_color_manual(values = c(my_palette[1], my_palette[2], my_palette[3])) +
scale_fill_manual(values = c(my_palette[1], my_palette[2], my_palette[3])) +
labs(title = "Insurance Charges by Age Group",
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
scale_color_manual(values = c(my_palette[1], my_palette[2], my_palette[3])) +
scale_fill_manual(values = c(my_palette[1], my_palette[2], my_palette[3])) +
labs(title = "Insurance Charges by Age Group")
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
scale_color_manual(values = c(my_palette[1], my_palette[3], my_palette[2])) +
scale_fill_manual(values = c(my_palette[1], my_palette[3], my_palette[2])) +
labs(title = "Insurance Charges by Age Group")
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
labs(title = "Insurance Charges by Age Group")
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
ggtitle = ("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
my_palette <- brewer.pal(3, "Pastel1")
names(my_palette)<-c('elder','young','senior')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
ggtitle = ("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.6),color='black')+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.5),color='black')+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.3),color='black')+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group,alpha=0.001),color='black')+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),alpha=0.001,color='black')+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),alpha=0.3,color='black')+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),alpha=0.3,color='black')+
theme_classic()+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),alpha=0.3,color='black')+
guides(fill = FALSE)+
theme_classic()+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
model_aov<-aov(insurance['charges']~insurance['age_group']);anova(model_aov)
model_aov<-aov(insurance[,'charges']~insurance[,'age_group']);anova(model_aov)
model_aov<-aov(insurance[,'bmi']~insurance[,'age_group']);anova(model_aov)
model_aov<-aov(insurance[,'age']~insurance[,'region']);anova(model_aov)
model_aov<-aov(insurance[,'age']~insurance[,'region']);anova(model_aov)
#모델 만들기;ANOVA실행하기
charges<-insurance[,'charges']
agegroup<-insurance[,'age_group']
model_aov<-aov(charges~agegroup);anova(model_aov)
bmi<-insurance[,'bmi']
model_aov<-aov(bmi~agegroup);anova(model_aov)
model_aov<-aov(age~region);anova(model_aov)
age<-insurance[,'ages']
age<-insurance[,'age']
region<-insurance[,'region']
model_aov<-aov(age~region);anova(model_aov)
model_aov<-aov(charges~agegroup+smoker+agegroup*smoker);anova(model_aov)
smoker<-insurance['smoker']
smoker<-insurance[,'smoker']
smoker<-insurance[,'smoker']
model_aov<-aov(charges~agegroup+smoker+agegroup*smoker);anova(model_aov)
smoker<-insurance[,'smoker']
model_aov<-aov(charges~agegroup+smoker+agegroup*smoker);anova(model_aov)
knitr::opts_chunk$set(echo = TRUE)
setwd("D:/psat 31기/1주차/문제")
library(tidyverse)
library(data.table)
library(magrittr)
library(corrplot)
library(RColorBrewer)
insurance<-read.csv('insurance.csv')
str(insurance)
head(insurance)
tail(insurance)
insurance %>%
lapply(n_distinct)
#수치형 변수
insurance %>%  select_if(is.numeric) %>% names()
#수치형 변수 numeric으로 변환
insurance <- insurance %>%
mutate_if(is.numeric,as.numeric)
#범주형 변수
insurance %>%  select_if(function(x) !is.numeric(x)) %>% names()
#범주형 변수 factor로 변환
insurance<- insurance %>%
mutate_if(function(x) !is.numeric(x),as.factor)
#결측치 확인
insurance %>% is.na() %>%  sum()
#데이터타입 변경 확인
str(insurance)
#조건에 따라 age_group열 생성성
insurance<-insurance %>%
mutate(age_group=case_when(
age>=18 & age <=35 ~ 'young',
age>=36 & age <55 ~'senior',
TRUE ~'elder'
))
#결과 확인
head(insurance,3)
num_vars <-c('age','bmi','charges')
insurance_num<-insurance[,num_vars]
num_corr<-cor(insurance_num)
corrplot(num_corr,method='shade',order='AOE',main='Correlation of Numeric Variables',mar=c(2,2,2,2))
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
my_palette <- brewer.pal(3, "Pastel1")
names(my_palette)<-c('elder','young','senior')
insurance %>% ggplot(aes(x=age_group,y=charges))+
geom_boxplot(aes(colour=age_group,fill=age_group),alpha=0.3,color='black')+
guides(fill = FALSE)+
theme_classic()+
ggtitle("나이 그룹에 따른 평균 요금 비교")+
theme(plot.title=element_text(hjust=0.5,face='bold'))
#모델 만들기;ANOVA실행하기
charges<-insurance[,'charges']
agegroup<-insurance[,'age_group']
model_aov<-aov(charges~agegroup);anova(model_aov)
bmi<-insurance[,'bmi']
model_aov<-aov(bmi~agegroup);anova(model_aov)
age<-insurance[,'age']
region<-insurance[,'region']
model_aov<-aov(age~region);anova(model_aov)
smoker<-insurance[,'smoker']
model_aov<-aov(charges~agegroup+smoker+agegroup*smoker);anova(model_aov)
library(tidyverse)
# Subset the data to only include categorical columns
cat_cols <- names(insurance)[sapply(insurance, is.factor)]
cat_df <- insurance[cat_cols]
# Function to calculate Cramer's V
cramers_v <- function(x, y) {
confusion_matrix <- table(x, y)
chi_sq <- chisq.test(confusion_matrix)$statistic
n <- sum(confusion_matrix)
phi_sq <- chi_sq / n
r <- dim(confusion_matrix)[1]
k <- dim(confusion_matrix)[2]
phi_corr <- max(0, phi_sq - (k - 1) * (r - 1) / (n - 1))
sqrt(phi_corr / min(k - 1, r - 1))
}
# Calculate Cramer's V for all pairs of categorical variables
cramers_v_matrix <- sapply(cat_cols, function(col1) {
sapply(cat_cols, function(col2) {
cramers_v(cat_df[[col1]], cat_df[[col2]])
})
})
colnames(cramers_v_matrix) <- cat_cols
rownames(cramers_v_matrix) <- cat_cols
cramers_v_df <- as.data.frame(cramers_v_matrix)
# Plot heatmap of Cramer's V values
ggplot(data = melt(cramers_v_df), aes(Var2, Var1, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "steelblue") +
labs(title = "Cramer's V of categorical values", x = "", y = "") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
cramers_v <- function(x, y) {
confusion_matrix <- table(x, y)
chi_sq <- chisq.test(confusion_matrix)$statistic
n <- sum(confusion_matrix)
phi_sq <- chi_sq / n
r <- dim(confusion_matrix)[1]
k <- dim(confusion_matrix)[2]
phi_corr <- max(0, phi_sq - (k - 1) * (r - 1) / (n - 1))
sqrt(phi_corr / min(k - 1, r - 1))
}
cat_cols <- names(insurance)[sapply(insurance, is.factor)]
cat_df <- insurance[cat_cols]
cramers_v_matrix <- sapply(cat_cols, function(col1) {
sapply(cat_cols, function(col2) {
cramers_v(cat_df[[col1]], cat_df[[col2]])
})
})
colnames(cramers_v_matrix) <- cat_cols
rownames(cramers_v_matrix) <- cat_cols
cramers_v_df <- as.data.frame(cramers_v_matrix)
ggplot(data = melt(cramers_v_df), aes(Var2, Var1, fill = value)) +
geom_tile(color = "white") +
scale_fill_gradient(low = "white", high = "steelblue") +
labs(title = "Cramer's V of categorical values", x = "", y = "") +
theme_minimal() +
theme(axis.text.x = element_text(angle = 45, hjust = 1),
panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
legend.position = "none")
#색상 설정
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
#ggplot으로 그래프 그리기
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
#histplot
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
#density plot
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
#색상 설정
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
#ggplot으로 그래프 그리기
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
#histplot
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
#density plot
geom_density(aes(colour=smoker,fill=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
#색상 설정
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
#ggplot으로 그래프 그리기
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
#histplot
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
#density plot
geom_density(aes(colour=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
#ggplot으로 그래프 그리기
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
#histplot
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
#density plot
geom_density(aes(colour=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
#색상 설정
my_palette <- brewer.pal(2, "Pastel1")
names(my_palette) <- c("no", "yes")
#ggplot으로 그래프 그리기
insurance %>%
ggplot(aes(x = charges, fill = smoker)) +
#histplot
geom_histogram(aes(y=..density..,colour=smoker),binwidth = 1200, alpha = 0.8) +
#density plot
geom_density(aes(colour=smoker),alpha=0.5)+
scale_fill_manual(values = my_palette) +
facet_wrap(~smoker, ncol = 2, scales = "free",drop=TRUE) +
labs(x = "charges", y = "density") +
theme_classic()+
ggtitle('흡연 여부에 따른 요금 분포 비교')+
theme(plot.title=element_text(hjust=0.5,face='bold'))
